---
import Layout from '@layouts/Layout.astro';
import Grid from '@components/Grid.astro';
import GridBox from '@components/GridBox.astro';
import SectionContent from '@components/SectionContent.astro';
import { Icon } from 'astro-icon/components';
import { brandKit } from '@data/brand-kit';
import { marked } from 'marked';

// Configure marked to render links properly
marked.setOptions({
    breaks: true,
    gfm: true
});

// Map 20-level bio array to 4 traditional levels for media kit
// Level indices: 0=Minimal, 5=Brief end, 12=Detailed mid, 19=Complete
const bioLevels = {
    tldr: { index: 0, label: 'TLDR' },
    short: { index: 5, label: 'Short' },
    medium: { index: 12, label: 'Medium' },
    long: { index: 19, label: 'Long' }
};

// Convert markdown bios to HTML
const biosHTML = Object.entries(bioLevels).reduce((acc, [key, { index }]) => {
    acc[key] = marked.parse(brandKit.bios[index]);
    return acc;
}, {} as Record<string, string>);
---

<Layout
    title="Brand Kit | Rashad"
    description="Logos, photos, bios, and brand assets for media coverage"
>
    <Grid classes="py-40">
        <GridBox desktopFull>
            <SectionContent title="Media & Brand Kit" classes="!px-0">
                <p>
                    Resources for media coverage, speaking engagements, and collaborations.
                    Feel free to use these assets with proper attribution.
                </p>
            </SectionContent>

            <!-- Bio and Speaker Profile Versions -->
            <div class="my-12">
                <h2 class="text-2xl font-bold mb-6">Bio and Speaker Profile Versions</h2>

                <!-- Tab Selector -->
                <div class="flex flex-wrap gap-2 mb-6">
                    <button data-bio-tab="tldr" class="bio-tab px-4 py-2 rounded-lg font-medium transition-all">
                        TLDR
                    </button>
                    <button data-bio-tab="short" class="bio-tab active px-4 py-2 rounded-lg font-medium transition-all">
                        Short
                    </button>
                    <button data-bio-tab="medium" class="bio-tab px-4 py-2 rounded-lg font-medium transition-all">
                        Medium
                    </button>
                    <button data-bio-tab="long" class="bio-tab px-4 py-2 rounded-lg font-medium transition-all">
                        Long
                    </button>
                </div>

                <!-- Bio Cards -->
                <div class="space-y-6">
                    {Object.entries(bioLevels).map(([key, { index, label }]) => {
                        const bio = brandKit.bios[index];
                        return (
                            <div data-bio-content={key} class="bio-content border border-neutral-200 rounded-lg p-6 bg-white">
                                <div class="flex items-start justify-between mb-3">
                                    <h3 class="font-semibold text-lg text-neutral-900">
                                        {label} Bio
                                    </h3>
                                    <button
                                        onclick={`navigator.clipboard.writeText(\`${bio.replace(/`/g, '\\`')}\`); this.querySelector('span').textContent = 'Copied!'; setTimeout(() => this.querySelector('span').textContent = 'Copy', 2000)`}
                                        class="px-3 py-1 text-sm bg-neutral-100 hover:bg-neutral-200 text-neutral-700 rounded transition-colors flex items-center gap-1"
                                    >
                                        <Icon name="ph:copy" width={16} height={16} />
                                        <span>Copy</span>
                                    </button>
                                </div>
                                <div class="prose prose-neutral max-w-none text-neutral-700 leading-relaxed" set:html={biosHTML[key]} />
                            </div>
                        );
                    })}
                </div>
            </div>

            <!-- Topics -->
            <div class="my-12">
                <h2 class="text-2xl font-bold mb-6">Speaking Topics</h2>
                <div class="flex flex-wrap gap-2">
                    {brandKit.topics.map((topic) => (
                        <span class="px-4 py-2 bg-blue-100 text-blue-700 rounded-full font-medium">
                            {topic}
                        </span>
                    ))}
                </div>
            </div>

            <!-- Social Links -->}
            <div class="my-12">
                <h2 class="text-2xl font-bold mb-6">Social Media</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    {brandKit.socialLinks.map((link) => (
                        <a
                            href={link.url}
                            target="_blank"
                            rel="noopener noreferrer"
                            class="border border-neutral-200 rounded-lg p-4 bg-white hover:shadow-md transition-all duration-300 group"
                        >
                            <div class="flex items-center gap-3">
                                <div class="text-neutral-600 group-hover:text-blue-600 transition-colors">
                                    <Icon name="ph:link" width={24} height={24} />
                                </div>
                                <div>
                                    <div class="font-semibold text-neutral-900">
                                        {link.platform}
                                    </div>
                                    <div class="text-sm text-neutral-600 font-mono">
                                        {link.username}
                                    </div>
                                </div>
                            </div>
                        </a>
                    ))}
                </div>
            </div>

            <!-- Photos & Assets -->
            <div class="my-12">
                <h2 class="text-2xl font-bold mb-6">Photos & Assets</h2>
                <p class="text-neutral-600 mb-6">
                    High-resolution photos for media use. Please provide attribution when using.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    {brandKit.photos.map((photo) => (
                        <div class="border border-neutral-200 rounded-lg p-4 bg-white">
                            <div class="aspect-square bg-neutral-100 rounded-lg mb-4 overflow-hidden">
                                <img
                                    src={photo.url}
                                    alt={photo.name}
                                    class="w-full h-full object-cover"
                                />
                            </div>
                            <h4 class="font-semibold text-neutral-900 mb-2">
                                {photo.name}
                            </h4>
                            {photo.description && (
                                <p class="text-sm text-neutral-600 mb-3">
                                    {photo.description}
                                </p>
                            )}
                            <a
                                href={photo.downloadUrl}
                                download
                                class="inline-flex items-center gap-1 text-sm font-medium text-blue-600 hover:text-blue-700 transition-colors"
                            >
                                <Icon name="ph:download-simple" width={16} height={16} />
                                <span>Download</span>
                            </a>
                        </div>
                    ))}
                </div>
            </div>

        </GridBox>
    </Grid>
</Layout>

<style>
    /* Tab Styles */
    .bio-tab {
        background-color: #f5f5f5;
        color: #666;
    }

    .bio-tab:hover {
        background-color: #e5e5e5;
    }

    .bio-tab.active {
        background-color: #3B82F6;
        color: white;
    }

    /* Bio Content Visibility */
    .bio-content {
        display: none;
    }

    .bio-content.active {
        display: block;
    }

    /* Bio Markdown Styling */
    .bio-content .prose {
        color: inherit;
    }

    .bio-content .prose p {
        margin-bottom: 1em;
    }

    .bio-content .prose p:last-child {
        margin-bottom: 0;
    }

    .bio-content .prose a {
        color: #3B82F6;
        text-decoration: none;
        transition: color 0.2s;
    }

    .bio-content .prose a:hover {
        color: #2563EB;
        text-decoration: underline;
    }

    .bio-content .prose strong {
        font-weight: 700;
        color: #171717;
    }
</style>

<script>
    // Bio tab switching functionality
    document.addEventListener('DOMContentLoaded', function() {
        const tabs = document.querySelectorAll('.bio-tab');
        const contents = document.querySelectorAll('.bio-content');

        // Show short bio by default
        const defaultBio = document.querySelector('[data-bio-content="short"]');
        if (defaultBio) {
            defaultBio.classList.add('active');
        }

        tabs.forEach(tab => {
            tab.addEventListener('click', function() {
                const targetBio = this.getAttribute('data-bio-tab');

                // Remove active class from all tabs
                tabs.forEach(t => t.classList.remove('active'));

                // Add active class to clicked tab
                this.classList.add('active');

                // Hide all bio contents
                contents.forEach(content => content.classList.remove('active'));

                // Show the selected bio content
                const targetContent = document.querySelector(`[data-bio-content="${targetBio}"]`);
                if (targetContent) {
                    targetContent.classList.add('active');
                }
            });
        });
    });
</script>
